
#################################################
##############   LITTLE EXAMPLE   ###############
#################################################

FASTA = ale.fa
VFC   = ale.vcf
FASTQ = ale.fq

GEDS  = ale.geds
ADJ   = ale.geds.adj
2FA   = ale.geds.2fa
INDEX = ale.min
k     = 3
w     = 3

SAM   = ale.sam

ale: ../gedmap $(SAM)
	#
	#
	# GEDS GENERATED BY GEDS:
	awk 1 $(GEDS)
	#
	#
	# SAM FILE:
	cat $(SAM)

../gedmap:
	cd .. && make gedmap



#PARSE TO GEDS
$(GEDS): $(FASTA) $(VFC) ../gedmap
	../gedmap parse $(FASTA) $(VFC) -o $(GEDS)

#GENERATE INDEX OF GEDS
$(INDEX):  $(GEDS) ../gedmap
	../gedmap index  $(GEDS) -2fa $(2FA) -k $(k) -w $(w) -o $(INDEX) -a $(ADJ)

#ALIGN TO GEDS USING INDEX
$(SAM): $(GEDS) $(INDEX) $(FASTQ) ../gedmap
	../gedmap align  $(FASTQ) $(GEDS)  $(INDEX) -o $(SAM) -a $(ADJ) -rc  -mao 1 -2fa $(2FA) -d 10



GFA        = ale.gfa
GFA_GEDS   = ale.gfa.geds
GFA_ADJ    = ale.gfa.adj
GFA_2GFA   = ale.gfa.2gfa
GFA_INDEX  = ale.gfa.min
GFA_SAM    = ale.gfa.sam

ale_gfa: ../gedmap $(GFA_SAM)
	#
	#
	# GEDS GENERATED BY GEDS:
	awk 1 $(GFA_GEDS)
	#
	#
	# SAM FILE:
	cat $(GFA_SAM)

#PARSE TO GEDS
$(GFA_GEDS): $(GFA)  ../gedmap
	../gedmap parse_gfa  $(GFA)

#GENERATE INDEX
$(GFA_INDEX):  $(GFA_GEDS) ../gedmap
	../gedmap index  $(GFA_GEDS) -k $(k) -w $(w) -o $(GFA_INDEX) -a $(GFA_ADJ)

#ALIGN TO GEDS USING INDEX
$(GFA_SAM): $(GFA_GEDS) $(GFA_INDEX) $(FASTQ) ../gedmap
	../gedmap align  $(FASTQ) $(GFA_GEDS)  $(GFA_INDEX) -o $(GFA_SAM) -a $(GFA_ADJ) -rc  -mao 1 -2gfa $(GFA_2GFA) -d 10

clean:
	rm -f $(GEDS) $(INDEX) $(SAM) $(2FA) $(ADJ) $(GFA_GEDS) $(GFA_ADJ) $(GFA_2GFA) $(GFA_INDEX) $(GFA_SAM) $(FASTA).fai $(GFA).transformed.gfa
